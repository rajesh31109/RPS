<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Voice Rock Paper Scissors Arena</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Orbitron', monospace; }
    .glass { background:rgba(255,255,255,0.10); backdrop-filter:blur(16px); border:1px solid rgba(255,255,255,0.10); }
    .glass-dark { background:rgba(40,40,80,0.27); backdrop-filter:blur(12px); border:1px solid rgba(255,255,255,0.13);}
    .stars { position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:0;}
    .star { position:absolute; background:white; border-radius:50%; animation:twinkle 3s infinite;}
    .star:nth-child(odd){ animation-delay:1.5s;}
    @keyframes twinkle { 0%,100%{ opacity:0.4; transform:scale(1);} 50%{opacity:1; transform:scale(1.2);} }
    .moving-star{ animation:moveStars 8s infinite ease-in-out;}
    @keyframes moveStars {
      0%{ transform:translateY(0) translateX(0);}
      25%{transform:translateY(-10px) translateX(5px);}
      50%{transform:translateY(-5px) translateX(-3px);}
      75%{transform:translateY(-15px) translateX(8px);}
      100%{transform:translateY(0) translateX(0);}
    }
    .pulse-ring { animation: pulse-ring 1.5s cubic-bezier(0.215,0.61,0.355,1) infinite;}
    @keyframes pulse-ring {
      0% {transform: scale(.33); opacity: 1;}
      80%,100% {transform: scale(2.33); opacity: 0;}
    }
  </style>
</head>
<body class="bg-gradient-to-tr from-blue-900 via-purple-900 to-indigo-900 min-h-screen overflow-hidden">

  <!-- Decorative stars -->
  <div class="stars" id="starsContainer"></div>

  <!-- Welcome Screen -->
  <div id="welcomeScreen" class="fixed inset-0 flex flex-col items-center justify-center z-40 bg-gradient-to-br from-indigo-800 to-purple-800">
    <div class="text-center">
      <h1 class="text-5xl md:text-7xl font-black text-white mb-4 tracking-wide drop-shadow-lg">WELCOME</h1>
      <p class="text-2xl md:text-3xl text-pink-200 font-bold mb-8 drop-shadow">TO RPS ARENA</p>
      <div class="inline-block animate-spin rounded-full h-14 w-14 border-4 border-white border-t-transparent"></div>
    </div>
  </div>

  <!-- Main Game Panel -->
  <main id="gameDashboard" class="hidden min-h-screen flex items-center justify-center px-2 py-10">
    <div class="max-w-4xl w-full game-container rounded-3xl p-8 shadow-2xl glass">

      <!-- Heading -->
      <div class="text-center mb-8">
        <h2 class="text-4xl md:text-6xl font-black bg-gradient-to-r from-yellow-400 via-pink-400 to-purple-700 bg-clip-text text-transparent mb-2 drop-shadow">üéÆ Rock Paper Scissors</h2>
        <div class="text-lg text-blue-100 font-bold tracking-widest">Challenge the Computer. Go Vocal!</div>
      </div>

      <!-- Scoreboard -->
      <div class="rounded-2xl p-6 mb-8 bg-white/5 glass">
        <div class="grid grid-cols-3 gap-5 text-center">
          <div class="glass-dark rounded-xl p-4">
            <div class="text-sm text-blue-300 font-semibold">YOU</div>
            <div id="playerScore" class="text-3xl md:text-4xl font-black text-green-400">0</div>
          </div>
          <div class="glass-dark rounded-xl p-4">
            <div class="text-sm text-blue-300 font-semibold">COMPUTER</div>
            <div id="computerScore" class="text-3xl md:text-4xl font-black text-red-400">0</div>
          </div>
          <div class="glass-dark rounded-xl p-4">
            <div class="text-sm text-blue-300 font-semibold">TIES</div>
            <div id="tieScore" class="text-3xl md:text-4xl font-black text-yellow-400">0</div>
          </div>
        </div>
      </div>

      <!-- Choices -->
      <div class="flex justify-center gap-4 md:gap-8 mb-8 flex-wrap">
        <button class="choice-btn glass rounded-2xl p-7 text-5xl md:text-6xl min-w-[110px] min-h-[110px] font-bold text-white hover:text-yellow-300 transition hover:-translate-y-2 hover:scale-105"
                onclick="playGame('rock')" aria-label="Rock">ü™®</button>
        <button class="choice-btn glass rounded-2xl p-7 text-5xl md:text-6xl min-w-[110px] min-h-[110px] font-bold text-white hover:text-yellow-300 transition hover:-translate-y-2 hover:scale-105"
                onclick="playGame('paper')" aria-label="Paper">üìÑ</button>
        <button class="choice-btn glass rounded-2xl p-7 text-5xl md:text-6xl min-w-[110px] min-h-[110px] font-bold text-white hover:text-yellow-300 transition hover:-translate-y-2 hover:scale-105"
                onclick="playGame('scissors')" aria-label="Scissors">‚úÇÔ∏è</button>
      </div>

      <!-- Voice Control -->
      <div class="flex flex-col items-center mb-8">
        <div class="relative mb-2">
          <button id="voiceBtn"
            class="relative z-10 bg-gradient-to-r from-pink-500 to-red-500 hover:from-purple-500 hover:to-indigo-500 text-white font-bold py-3 px-8 rounded-full text-lg shadow-lg transition-all"
            onclick="toggleVoiceRecognition()">
            üé§ Start Voice Recognition
          </button>
          <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
            <span class="pulse-ring w-full h-full rounded-full bg-pink-400 opacity-0" id="pulseRing"></span>
          </div>
        </div>
        <div id="voiceStatus" class="glass-dark rounded-xl p-3 mt-1 text-blue-200 text-sm font-medium max-w-md mx-auto text-center">
          Click the microphone and say "rock", "paper", or "scissors"
        </div>
      </div>

      <!-- Result -->
      <div class="glass rounded-2xl p-6 mb-6 hidden" id="gameResult">
        <div class="flex justify-center items-center gap-8 mb-4">
          <div class="text-center">
            <div class="text-5xl md:text-6xl mb-2" id="playerChoice"></div>
            <div class="text-blue-300 font-semibold">You</div>
          </div>
          <div class="text-3xl font-black text-white">VS</div>
          <div class="text-center">
            <div class="text-5xl md:text-6xl mb-2" id="computerChoice"></div>
            <div class="text-blue-300 font-semibold">Computer</div>
          </div>
        </div>
        <div class="text-center">
          <p class="text-2xl md:text-3xl font-black" id="resultText"></p>
        </div>
      </div>

      <!-- Reset button -->
      <div class="text-center">
        <button class="bg-gradient-to-r from-purple-500 to-indigo-600 hover:from-pink-600 hover:to-purple-700 text-white font-bold py-3 px-8 rounded-full text-lg transition hover:scale-105 shadow-lg"
                onclick="resetGame()">
          üîÑ Reset Game
        </button>
      </div>
      <!-- Instructions -->
      <div class="glass-dark rounded-xl p-4 mt-8 text-sm text-blue-200">
        <div class="font-bold text-white mb-2">üéØ How to play:</div>
        <div class="space-y-1">
          <div>‚Ä¢ Click Rock, Paper, or Scissors</div>
          <div>‚Ä¢ OR use voice: say "rock", "paper", or "scissors"</div>
          <div>‚Ä¢ Rock beats Scissors, Scissors beats Paper, Paper beats Rock</div>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Star field background
    function createStars() {
      const starsContainer = document.getElementById('starsContainer');
      const numberOfStars = 110;
      for (let i = 0; i < numberOfStars; i++) {
        const star = document.createElement('div');
        star.className = 'star moving-star';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        const size = Math.random() * 3 + 1;
        star.style.width = size + 'px';
        star.style.height = size + 'px';
        star.style.animationDelay = Math.random() * 3 + 's';
        starsContainer.appendChild(star);
      }
    }

    let playerScore = 0, computerScore = 0, tieScore = 0;
    let isListening = false, recognition;
    const choices = {
      rock: { emoji: 'ü™®', beats: 'scissors' },
      paper: { emoji: 'üìÑ', beats: 'rock' },
      scissors: { emoji: '‚úÇÔ∏è', beats: 'paper' }
    };

    function isSpeechRecognitionSupported() {
      return 'webkitSpeechRecognition' in window || 'SpeechRecognition' in window;
    }

    function getRecognitionObject() {
      return window.SpeechRecognition ? new window.SpeechRecognition() :
             window.webkitSpeechRecognition ? new window.webkitSpeechRecognition() : null;
    }

    let recognitionInitialized = false;

    function initSpeechRecognition() {
      if (!isSpeechRecognitionSupported()) {
        document.getElementById('voiceStatus').textContent = '‚ùå Voice recognition not supported in this browser';
        document.getElementById('voiceBtn').style.display = 'none';
        return;
      }
      if (recognitionInitialized) return;
      recognition = getRecognitionObject();
      recognition.continuous = false;
      recognition.interimResults = false;
      recognition.lang = 'en-US';
      recognitionInitialized = true;

      recognition.onstart = function() {
        isListening = true;
        updateVoiceUI();
        document.getElementById('voiceStatus').textContent = 'üéØ Listening... Say "rock", "paper", or "scissors"';
      };

      recognition.onresult = function(event) {
        if(!event.results || !event.results[0] || !event.results[0][0]) return;
        const result = event.results[0][0].transcript.toLowerCase().trim();
        if (result.includes('rock')) playGame('rock');
        else if (result.includes('paper')) playGame('paper');
        else if (result.includes('scissors') || result.includes('scissor')) playGame('scissors');
        else document.getElementById('voiceStatus').textContent = '‚ùå Say "rock", "paper", or "scissors". Try again!';
      };

      recognition.onerror = function() {
        document.getElementById('voiceStatus').textContent = '‚ö†Ô∏è Voice recognition error. Try again!';
        isListening = false;
        updateVoiceUI();
      };

      recognition.onend = function() {
        isListening = false;
        updateVoiceUI();
        if (document.getElementById('voiceStatus').textContent.includes('Listening')) {
          document.getElementById('voiceStatus').textContent = 'Click the microphone and say "rock", "paper", or "scissors"';
        }
      };
    }

    function toggleVoiceRecognition() {
      if (!recognitionInitialized) initSpeechRecognition();
      if (!recognition) return;
      if (isListening) {
        recognition.stop();
      } else {
        try {
          recognition.start();
        } catch (e) {
          document.getElementById('voiceStatus').textContent = '‚ùå Failed to start voice recognition. Try again!';
        }
      }
    }
    function updateVoiceUI() {
      const voiceBtn = document.getElementById('voiceBtn');
      const pulseRing = document.getElementById('pulseRing');
      if (isListening) {
        voiceBtn.textContent = 'üî¥ Stop Listening';
        voiceBtn.className = voiceBtn.className.replace('from-pink-500 to-red-500', 'from-blue-500 to-cyan-500');
        pulseRing.style.opacity = '0.25';
      } else {
        voiceBtn.textContent = 'üé§ Start Voice Recognition';
        voiceBtn.className = voiceBtn.className.replace('from-blue-500 to-cyan-500', 'from-pink-500 to-red-500');
        pulseRing.style.opacity = '0';
      }
    }

    function getComputerChoice() {
      return ['rock', 'paper', 'scissors'][Math.floor(Math.random() * 3)];
    }
    function determineWinner(playerChoice, computerChoice) {
      if (playerChoice === computerChoice) return 'tie';
      return (choices[playerChoice].beats === computerChoice) ? 'win' : 'lose';
    }
    function playGame(playerChoice) {
      const computerChoice = getComputerChoice();
      const result = determineWinner(playerChoice, computerChoice);
      if (result === 'win') playerScore++;
      else if (result === 'lose') computerScore++;
      else tieScore++;
      updateScores();
      displayResult(playerChoice, computerChoice, result);
      if (isListening && recognition) recognition.stop();
    }
    function updateScores() {
      document.getElementById('playerScore').textContent = playerScore;
      document.getElementById('computerScore').textContent = computerScore;
      document.getElementById('tieScore').textContent = tieScore;
    }
    function displayResult(playerChoice, computerChoice, result) {
      document.getElementById('playerChoice').textContent = choices[playerChoice].emoji;
      document.getElementById('computerChoice').textContent = choices[computerChoice].emoji;
      let resultMessage = '', resultClass = '';
      if (result === 'win') { resultMessage = 'üéâ You Win!'; resultClass = 'text-green-400';}
      else if (result === 'lose') { resultMessage = 'üòî You Lose!'; resultClass = 'text-red-400';}
      else { resultMessage = 'ü§ù It\'s a Tie!'; resultClass = 'text-yellow-400';}
      const resultText = document.getElementById('resultText');
      resultText.textContent = resultMessage;
      resultText.className = `text-2xl md:text-3xl font-black ${resultClass}`;
      document.getElementById('gameResult').classList.remove('hidden');
    }
    function resetGame() {
      playerScore = 0; computerScore = 0; tieScore = 0;
      updateScores();
      document.getElementById('gameResult').classList.add('hidden');
      document.getElementById('voiceStatus').textContent = 'Click the microphone and say "rock", "paper", or "scissors"';
      if (isListening && recognition) recognition.stop();
    }

    // App initialize
    window.onload = function() {
      createStars();
      updateScores();
      setTimeout(()=>{
        document.getElementById('welcomeScreen').style.display = 'none';
        document.getElementById('gameDashboard').classList.remove('hidden');
        document.body.style.overflow = 'auto';
        initSpeechRecognition(); // Initialize on load for Chrome permissions prompt
      }, 1800);
    };
  </script>
</body>
</html>
